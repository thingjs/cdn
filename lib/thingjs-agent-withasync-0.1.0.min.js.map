{"version":3,"file":"thingjs-agent-withasync-0.1.0.min.js","sources":["async-0.9.0.js","thingjs-agent-0.1.0.js"],"names":["only_once","fn","called","Error","apply","root","arguments","previous_async","async","this","noConflict","_toString","Object","prototype","toString","_isArray","Array","isArray","obj","call","_each","arr","iterator","forEach","i","length","_map","map","results","x","a","push","_reduce","memo","reduce","_keys","keys","k","hasOwnProperty","process","nextTick","setImmediate","setTimeout","each","callback","done","err","completed","eachSeries","iterate","forEachSeries","eachLimit","limit","_eachLimit","forEachLimit","started","running","replenish","doParallel","args","slice","concat","doParallelLimit","doSeries","_asyncMap","eachfn","index","value","v","mapSeries","mapLimit","_mapLimit","inject","foldl","reduceRight","reversed","reverse","foldr","_filter","sort","b","filter","filterSeries","select","selectSeries","_reject","reject","rejectSeries","_detect","main_callback","result","detect","detectSeries","some","any","every","all","sortBy","criteria","left","right","auto","tasks","remainingTasks","listeners","addListener","unshift","removeListener","splice","taskComplete","theCallback","task","taskCallback","safeResults","rkey","requires","Math","abs","ready","listener","retry","times","DEFAULT_TIMES","attempts","parseInt","wrappedTask","wrappedCallback","wrappedResults","retryAttempt","finalAttempt","seriesCallback","series","data","waterfall","wrapIterator","next","_parallel","parallel","parallelLimit","makeCallback","_concat","r","cb","y","concatSeries","whilst","test","doWhilst","until","doUntil","queue","worker","concurrency","_insert","q","pos","drain","item","saturated","undefined","workers","empty","paused","kill","shift","idle","pause","resume","priorityQueue","_compareTasks","priority","_binarySearch","sequence","compare","beg","end","mid","cargo","payload","working","drained","ts","ds","_console_fn","name","console","error","log","dir","memoize","hasher","queues","memoized","pop","key","l","unmemoized","unmemoize","count","counter","timesSeries","seq","fns","that","newargs","nextargs","compose","_applyEach","go","applyEach","applyEachSeries","forever","module","exports","define","amd","_global","Mash","n","mash","charCodeAt","h","cbBuilder","self","cbDone","agent","cbObj","$thing","Container","_module","_getTicks","require","GLOBAL","hrtime","Date","now","heap","create64BitId","h1","h2","split","getBacktrace","first","e","trace","stack","match","merge","attach","def","_id","_refCount","search","searchMeta","predicate","type","meta","getMeta","_meta","isNaN","toLowerCase","switchContext","functString","parentOrdinal","superOrdinal","ordinal","superName","methodName","$vtable","indexOf","ret","$parent","$super","switchParentContext","getName","$inherit","inherit","parent","init","replace","j","signature","signatures","constructor","substring","$owner","$signatures","Base","property","prop","cbGetter","cbSetter","get","set","defineProperty","bind","funct","State","EXPR_AND","EXPR_NOT","EXPR_OR","DEF_DESC","DEF_NAME","DEF_SOURCE","DEF_EXTENDS","DEF_IMPLEMENTS","DEF_USES","DEF_META","DEF_NOP","DEF_END","LIFE_INITIATED","LIFE_ACTIVE","LIFE_WAITING","LIFE_SUSPENDED","LIFE_DELETED","LIFE_TRANSIT","LIFE_BLOCKED","Filter","ALL","FIRST","LAST","Definition","_metaHandlers","mobile","_isMobile","passive","_isPassive","singleton","_singleton","_source","catchall","_substitute","$__catchall__","_super","source","_state","_parent","_children","_interfaces","_uses","_isAgent","Agent","_isAbstract","$id","$source","parseStack","_extends","_name","_class","refObject","_instance","_childrenWrapper","_pushChild","_forEachChild","_countChildren","_factory","interfaces","getInterfaces","getHeapId","id","child","getRefCount","charAt","Boolean","RegExp","patchObject","getSource","getChildren","getState","setState","states","state","unsetState","isAbstract","unpatchObject","cbRelease","constructed","setup","takedown","Delegate","matchInterface","pattern","dispatch","method","Pattern","_pattern","toArray","doActivate","doDelete","doSuspend","doWait","doWake","addBehaviour","reset","Behaviour","refCount","instance","removeBehaviour","objs","children","action","$cb","block","restart","Selector","includePassive","include","_exprs","_selection","_callbacks","expr","and","not","isPassive","matchObject","m","cbItem","filters","interface","cbNext","release","WAKE_MIN_PERIOD","nextWakeTime","isActionTaskQueued","wakeTask","selector","lastWakeTime","enqueueActionTask","selects","callChain","callArgs","last","catchAll","getFlow","methods","names","cbYield","yield","getQueue","functs","active","flow","items","errs","getWakeTime","time","period","wake","stop"],"mappings":"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","sourcesContent":["/*!\n * async\n * https://github.com/caolan/async\n *\n * Copyright 2010-2014 Caolan McMahon\n * Released under the MIT license\n */\n/*jshint onevar: false, indent:4 */\n/*global setImmediate: false, setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root, previous_async;\n\n    root = this;\n    if (root != null) {\n      previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        var called = false;\n        return function() {\n            if (called) throw new Error(\"Callback was already called.\");\n            called = true;\n            fn.apply(root, arguments);\n        }\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _toString = Object.prototype.toString;\n\n    var _isArray = Array.isArray || function (obj) {\n        return _toString.call(obj) === '[object Array]';\n    };\n\n    var _each = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _each(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _each(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        if (typeof setImmediate === 'function') {\n            async.nextTick = function (fn) {\n                // not a direct alias for IE10 compatibility\n                setImmediate(fn);\n            };\n            async.setImmediate = async.nextTick;\n        }\n        else {\n            async.nextTick = function (fn) {\n                setTimeout(fn, 0);\n            };\n            async.setImmediate = async.nextTick;\n        }\n    }\n    else {\n        async.nextTick = process.nextTick;\n        if (typeof setImmediate !== 'undefined') {\n            async.setImmediate = function (fn) {\n              // not a direct alias for IE10 compatibility\n              setImmediate(fn);\n            };\n        }\n        else {\n            async.setImmediate = async.nextTick;\n        }\n    }\n\n    async.each = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _each(arr, function (x) {\n            iterator(x, only_once(done) );\n        });\n        function done(err) {\n          if (err) {\n              callback(err);\n              callback = function () {};\n          }\n          else {\n              completed += 1;\n              if (completed >= arr.length) {\n                  callback();\n              }\n          }\n        }\n    };\n    async.forEach = async.each;\n\n    async.eachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback();\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n    async.forEachSeries = async.eachSeries;\n\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        var fn = _eachLimit(limit);\n        fn.apply(null, [arr, iterator, callback]);\n    };\n    async.forEachLimit = async.eachLimit;\n\n    var _eachLimit = function (limit) {\n\n        return function (arr, iterator, callback) {\n            callback = callback || function () {};\n            if (!arr.length || limit <= 0) {\n                return callback();\n            }\n            var completed = 0;\n            var started = 0;\n            var running = 0;\n\n            (function replenish () {\n                if (completed >= arr.length) {\n                    return callback();\n                }\n\n                while (running < limit && started < arr.length) {\n                    started += 1;\n                    running += 1;\n                    iterator(arr[started - 1], function (err) {\n                        if (err) {\n                            callback(err);\n                            callback = function () {};\n                        }\n                        else {\n                            completed += 1;\n                            running -= 1;\n                            if (completed >= arr.length) {\n                                callback();\n                            }\n                            else {\n                                replenish();\n                            }\n                        }\n                    });\n                }\n            })();\n        };\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.each].concat(args));\n        };\n    };\n    var doParallelLimit = function(limit, fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [_eachLimit(limit)].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.eachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        if (!callback) {\n            eachfn(arr, function (x, callback) {\n                iterator(x.value, function (err) {\n                    callback(err);\n                });\n            });\n        } else {\n            var results = [];\n            eachfn(arr, function (x, callback) {\n                iterator(x.value, function (err, v) {\n                    results[x.index] = v;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = function (arr, limit, iterator, callback) {\n        return _mapLimit(limit)(arr, iterator, callback);\n    };\n\n    var _mapLimit = function(limit) {\n        return doParallelLimit(limit, _asyncMap);\n    };\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        var remainingTasks = keys.length\n        if (!remainingTasks) {\n            return callback();\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            remainingTasks--\n            _each(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (!remainingTasks) {\n                var theCallback = callback;\n                // prevent final callback from calling itself if it errors\n                callback = function () {};\n\n                theCallback(null, results);\n            }\n        });\n\n        _each(keys, function (k) {\n            var task = _isArray(tasks[k]) ? tasks[k]: [tasks[k]];\n            var taskCallback = function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _each(_keys(results), function(rkey) {\n                        safeResults[rkey] = results[rkey];\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.retry = function(times, task, callback) {\n        var DEFAULT_TIMES = 5;\n        var attempts = [];\n        // Use defaults if times not passed\n        if (typeof times === 'function') {\n            callback = task;\n            task = times;\n            times = DEFAULT_TIMES;\n        }\n        // Make sure times is a number\n        times = parseInt(times, 10) || DEFAULT_TIMES;\n        var wrappedTask = function(wrappedCallback, wrappedResults) {\n            var retryAttempt = function(task, finalAttempt) {\n                return function(seriesCallback) {\n                    task(function(err, result){\n                        seriesCallback(!err || finalAttempt, {err: err, result: result});\n                    }, wrappedResults);\n                };\n            };\n            while (times) {\n                attempts.push(retryAttempt(task, !(times-=1)));\n            }\n            async.series(attempts, function(done, data){\n                data = data[data.length - 1];\n                (wrappedCallback || callback)(data.err, data.result);\n            });\n        }\n        // If a callback is passed, run this as a controll flow\n        return callback ? wrappedTask() : wrappedTask\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (!_isArray(tasks)) {\n          var err = new Error('First argument to waterfall must be an array of functions');\n          return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback.apply(null, arguments);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.setImmediate(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    var _parallel = function(eachfn, tasks, callback) {\n        callback = callback || function () {};\n        if (_isArray(tasks)) {\n            eachfn.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            eachfn.each(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.parallel = function (tasks, callback) {\n        _parallel({ map: async.map, each: async.each }, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel({ map: _mapLimit(limit), each: _eachLimit(limit) }, tasks, callback);\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (_isArray(tasks)) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.eachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (test.apply(null, args)) {\n                async.doWhilst(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (!test.apply(null, args)) {\n                async.doUntil(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.queue = function (worker, concurrency) {\n        if (concurrency === undefined) {\n            concurrency = 1;\n        }\n        function _insert(q, data, pos, callback) {\n          if (!q.started){\n            q.started = true;\n          }\n          if (!_isArray(data)) {\n              data = [data];\n          }\n          if(data.length == 0) {\n             // call drain immediately if there are no tasks\n             return async.setImmediate(function() {\n                 if (q.drain) {\n                     q.drain();\n                 }\n             });\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n\n              if (pos) {\n                q.tasks.unshift(item);\n              } else {\n                q.tasks.push(item);\n              }\n\n              if (q.saturated && q.tasks.length === q.concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            started: false,\n            paused: false,\n            push: function (data, callback) {\n              _insert(q, data, false, callback);\n            },\n            kill: function () {\n              q.drain = null;\n              q.tasks = [];\n            },\n            unshift: function (data, callback) {\n              _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (!q.paused && workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if (q.empty && q.tasks.length === 0) {\n                        q.empty();\n                    }\n                    workers += 1;\n                    var next = function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if (q.drain && q.tasks.length + workers === 0) {\n                            q.drain();\n                        }\n                        q.process();\n                    };\n                    var cb = only_once(next);\n                    worker(task.data, cb);\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            },\n            idle: function() {\n                return q.tasks.length + workers === 0;\n            },\n            pause: function () {\n                if (q.paused === true) { return; }\n                q.paused = true;\n                q.process();\n            },\n            resume: function () {\n                if (q.paused === false) { return; }\n                q.paused = false;\n                q.process();\n            }\n        };\n        return q;\n    };\n    \n    async.priorityQueue = function (worker, concurrency) {\n        \n        function _compareTasks(a, b){\n          return a.priority - b.priority;\n        };\n        \n        function _binarySearch(sequence, item, compare) {\n          var beg = -1,\n              end = sequence.length - 1;\n          while (beg < end) {\n            var mid = beg + ((end - beg + 1) >>> 1);\n            if (compare(item, sequence[mid]) >= 0) {\n              beg = mid;\n            } else {\n              end = mid - 1;\n            }\n          }\n          return beg;\n        }\n        \n        function _insert(q, data, priority, callback) {\n          if (!q.started){\n            q.started = true;\n          }\n          if (!_isArray(data)) {\n              data = [data];\n          }\n          if(data.length == 0) {\n             // call drain immediately if there are no tasks\n             return async.setImmediate(function() {\n                 if (q.drain) {\n                     q.drain();\n                 }\n             });\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  priority: priority,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n              \n              q.tasks.splice(_binarySearch(q.tasks, item, _compareTasks) + 1, 0, item);\n\n              if (q.saturated && q.tasks.length === q.concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n        \n        // Start with a normal queue\n        var q = async.queue(worker, concurrency);\n        \n        // Override push to accept second parameter representing priority\n        q.push = function (data, priority, callback) {\n          _insert(q, data, priority, callback);\n        };\n        \n        // Remove unshift function\n        delete q.unshift;\n\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        var working     = false,\n            tasks       = [];\n\n        var cargo = {\n            tasks: tasks,\n            payload: payload,\n            saturated: null,\n            empty: null,\n            drain: null,\n            drained: true,\n            push: function (data, callback) {\n                if (!_isArray(data)) {\n                    data = [data];\n                }\n                _each(data, function(task) {\n                    tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    cargo.drained = false;\n                    if (cargo.saturated && tasks.length === payload) {\n                        cargo.saturated();\n                    }\n                });\n                async.setImmediate(cargo.process);\n            },\n            process: function process() {\n                if (working) return;\n                if (tasks.length === 0) {\n                    if(cargo.drain && !cargo.drained) cargo.drain();\n                    cargo.drained = true;\n                    return;\n                }\n\n                var ts = typeof payload === 'number'\n                            ? tasks.splice(0, payload)\n                            : tasks.splice(0, tasks.length);\n\n                var ds = _map(ts, function (task) {\n                    return task.data;\n                });\n\n                if(cargo.empty) cargo.empty();\n                working = true;\n                worker(ds, function () {\n                    working = false;\n\n                    var args = arguments;\n                    _each(ts, function (data) {\n                        if (data.callback) {\n                            data.callback.apply(null, args);\n                        }\n                    });\n\n                    process();\n                });\n            },\n            length: function () {\n                return tasks.length;\n            },\n            running: function () {\n                return working;\n            }\n        };\n        return cargo;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _each(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                async.nextTick(function () {\n                    callback.apply(null, memo[key]);\n                });\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n    async.times = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.map(counter, iterator, callback);\n    };\n\n    async.timesSeries = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.mapSeries(counter, iterator, callback);\n    };\n\n    async.seq = function (/* functions... */) {\n        var fns = arguments;\n        return function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([function () {\n                    var err = arguments[0];\n                    var nextargs = Array.prototype.slice.call(arguments, 1);\n                    cb(err, nextargs);\n                }]))\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        };\n    };\n\n    async.compose = function (/* functions... */) {\n      return async.seq.apply(null, Array.prototype.reverse.call(arguments));\n    };\n\n    var _applyEach = function (eachfn, fns /*args...*/) {\n        var go = function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            return eachfn(fns, function (fn, cb) {\n                fn.apply(that, args.concat([cb]));\n            },\n            callback);\n        };\n        if (arguments.length > 2) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return go.apply(this, args);\n        }\n        else {\n            return go;\n        }\n    };\n    async.applyEach = doParallel(_applyEach);\n    async.applyEachSeries = doSeries(_applyEach);\n\n    async.forever = function (fn, callback) {\n        function next(err) {\n            if (err) {\n                if (callback) {\n                    return callback(err);\n                }\n                throw err;\n            }\n            fn(next);\n        }\n        next();\n    };\n\n    // Node.js\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    // AMD / RequireJS\n    else if (typeof define !== 'undefined' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n","/*\nCopyright (c) 2015 Simon Cullen, http://github.com/cullens\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n(function(_global) {\n\n\t'use strict';\n\n\tvar _module,\n\t\t_getTicks,\n\t\tasync\n\t\t;\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tasync = require('async');\n\t\t_global = GLOBAL;\n\t\t_module = module;\n\t\t_getTicks = function() {\n\t\t\tvar hrtime = process.hrtime();\n\t\t\treturn hrtime[0] * 1000000 + hrtime[1];\n\t\t};\n\t}\n\telse {\n\t\tasync = _global.async;\n\t\t_getTicks = Date.now;\n\t}\n\n\tif (_global.$thing !== undefined) {\n\t\t(_module !== undefined)\n\t\t\t? _module.exports = agent\n\t\t\t: undefined\n\t\t\t;\n\t\treturn;\n\t}\n\n\t// Mash by Johannes Baage <baagoe@baagoe.com>\n\tfunction Mash() {\n  \t\tvar n = 0xefc8249d;\n  \t\tvar mash = function(data) {\n    \t\tdata = data.toString();\n    \t\tfor (var i = 0; i < data.length; i++) {\n      \t\t\tn += data.charCodeAt(i);\n      \t\t\tvar h = 0.02519603282416938 * n;\n      \t\t\tn = h >>> 0;\n      \t\t\th -= n;\n      \t\t\th *= n;\n      \t\t\tn = h >>> 0;\n      \t\t\th -= n;\n      \t\t\tn += h * 0x100000000; \n    \t\t}\n    \t\treturn (n >>> 0) * 2.3283064365386963e-10; \n  \t\t};\n  \t\treturn mash;\n\t}\n\n\t/** @namespace $thing */\n\tvar $thing = _global.$thing = {};\n\n\t$thing.heap = [];\n\n\t/**\n\t * @memberOf $thing\n\t * @method create64BitId\n\t */\n\t$thing.create64BitId = function() {\n\t\tvar h1 = new Mash(),\n\t\t\th2 = new Mash()\n\t\t\t;\n\t\tfor (var i = 0; i < arguments.length; i++) \n\t\t\th1(arguments[i] || '');\n\t\treturn  h1('').toString(16).split('.')[1] +\n\t\t\t\th2(_getTicks()).toString(16).split('.')[1]\n\t\t\t\t;\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method getBacktrace\n\t */\n\t$thing.getBacktrace = function(first) {\n\t\tfirst = first || 0;\n\t\ttry {\n\t\t\t0();\n\t\t}\n\t\tcatch(e) {\n\t\t\tvar trace;\n\t\t\tif ((trace = e.stack.match(/\\S+\\:\\d+/g)) !== null)\n\t\t\t\treturn trace.slice(1 + first);\n\t\t\telse if ((trace = e.stack.match(/\\s+at /g)) !== null)\n\t\t\t\treturn trace.slice(1 + first);\n\t\t\treturn [];\n\t\t}\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method merge\n\t */\n\t$thing.merge = function() {\n\t\tvar args = Array.prototype.slice.call(arguments, 0),\n\t\t\tobj = args[0],\n\t\t\ti = 1\n\t\t\t;\n\t\tfor(; i < args.length; i++)\n\t\t\tif (args[i] !== undefined)\n\t\t\t\tfor(var k in args[i])\n\t\t\t\t\t(obj[k] === undefined)\n\t\t\t\t\t\t? obj[k] = args[i][k]\n\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t;\n\t\treturn obj;\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method attach\n\t */\n\t$thing.attach = function(def) {\n\t\tif (def._id !== undefined) return def._id;\n\t\telse {\n\t\t\tvar length = $thing.heap.length;\n\t\t\twhile(\n\t\t\t\t$thing.heap.length !== 0 &&\n\t\t\t\t$thing.heap[$thing.heap.length - 1]._refCount === 0\n\t\t\t) ($thing.heap.pop())._id = undefined;\n\t\t\tif (!$thing.heap.length || $thing.heap.length !== length)\n\t\t\t\tdef._id = $thing.heap.push(def) - 1;\n\t\t\telse {\n\t\t\t\tdef._id = undefined;\n\t\t\t\tfor(var i = $thing.heap.length - 1;\n\t\t\t\t\ti > -1 && def._id === undefined;\n\t\t\t\t\ti--\n\t\t\t\t)\n\t\t\t\t\tif ($thing.heap[i]._refCount === 0) {\n\t\t\t\t\t\t$thing.heap[i]._id = undefined;\n\t\t\t\t\t\t$thing.heap[def._id = i] = def;\n\t\t\t\t\t}\n\t\t\t\t(def._id === undefined)\n\t\t\t\t\t? def._id = $thing.heap.push(def) - 1\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t}\n\t\t\treturn def._id;\n\t\t}\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method search\n\t */\n\t$thing.search = function(obj) {\n\t\tvar match;\n\t\tfor(var i = $thing.heap.length - 1; i > -1; i--) {\n\t\t\tif ($thing.heap[i]._refCount > 0) {\n\t\t\t\tfor(var k in obj)\n\t\t\t\t\tif (!(match = obj[k] === $thing.heap[i][k]))\n\t\t\t\t\t\tbreak;\n\t\t\t\tif (match)\n\t\t\t\t\treturn $thing.heap[i];\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method searchMeta\n\t */\n\t$thing.searchMeta = function(obj, predicate) {\n\t\tvar type = 'string',\n\t\t\tcb = arguments[2],\n\t\t\tmeta = (obj.getMeta !== undefined)\n\t\t\t\t? obj.getMeta()\n\t\t\t\t: obj._meta\n\t\t\t;\n\t\tswitch(arguments[2]) {\n\t\t\tcase 'int':\n\t\t\tcase 'boolean':\n\t\t\tcase 'string':\n\t\t\t\ttype = arguments[2];\n\t\t\t\tcb = arguments[3];\n\t\t}\n\t\tmeta.forEach(function(item) {\n\t\t\tif ((item = item.match(/\\S+/g))[0] === predicate) {\n\t\t\t\titem = item.slice(1);\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase 'int':\n\t\t\t\t\t\t(!isNaN(item[0] = parseInt(item[0])))\n\t\t\t\t\t\t\t? cb.apply(obj, item)\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'boolean':\n\t\t\t\t\t\tswitch(item[0].toLowerCase()) {\n\t\t\t\t\t\t\tcase 'true':\n\t\t\t\t\t\t\t\titem[0] = true;\n\t\t\t\t\t\t\t\tcb.apply(obj, item);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'false':\n\t\t\t\t\t\t\t\titem[0] = false;\n\t\t\t\t\t\t\t\tcb.apply(obj, item);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcb.apply(obj, item);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method switchContext\n\t */\n\t$thing.switchContext = function(\n\t\tfunctString,\n\t\tparentOrdinal,\n\t\tsuperOrdinal,\n\t\tordinal,\n\t\tsuperName,\n\t\tmethodName\n\t) {\n\t\tfunctString = functString || this.$vtable[ordinal][methodName].toString();\n\t\treturn (\n\t\t\tfunctString.indexOf('$parent') > -1 ||\n\t\t\tfunctString.indexOf('$super') > -1\n\t\t)\n\t\t\t? function() {\n\t\t\t\tvar ret,\n\t\t\t\t\t$parent = this.$parent,\n\t\t\t\t\t$super = this.$super\n\t\t\t\t\t;\n\t\t\t\tthis.$parent = this.$vtable[parentOrdinal] || $parent;\n\t\t\t\tthis.$super = this.$vtable[superOrdinal][superName];\n\t\t\t\tret = this.$vtable[ordinal][methodName].apply(this, arguments);\n\t\t\t\tthis.$parent = $parent;\n\t\t\t\tthis.$super = $super;\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\t: this.$vtable[ordinal][methodName]\n\t\t\t;\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method switchParentContext\n\t */\n\t$thing.switchParentContext = function(\n\t\tfunctString,\n\t\tparentOrdinal,\n\t\tordinal,\n\t\tmethodName\n\t) {\n\t\tfunctString = functString || this.$vtable[ordinal][methodName].toString();\n\t\treturn (\n\t\t\tfunctString.indexOf('$parent') > -1\n\t\t)\n\t\t\t? function() {\n\t\t\t\tvar ret,\n\t\t\t\t\t$parent = this.$parent\n\t\t\t\t\t;\n\t\t\t\tthis.$parent = this.$vtable[parentOrdinal] || this.$parent;\n\t\t\t\tret = this.$vtable[ordinal][methodName].apply(this, arguments);\n\t\t\t\tthis.$parent = $parent;\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\t: this.$vtable[ordinal][methodName]\n\t\t\t;\n\t};\n\n\t/**\n\t * @class Object\n\t * @memberOf $thing\n\t */\n\t$thing.Object = function(){};\n\n\t/**\n\t * Return object name\n\t * @memberOf $thing\n\t * @method Object#getName\n\t * @returns {string}\n\t */\n\t$thing.Object.prototype.getName = function(){\n\t\treturn 'Object';\n\t};\n\n\t/**\n\t * @memberOf $thing\n\t * @method Object.inherit\n\t * @param {object} obj\n\t * @param {object} parent\n\t * @returns {object}\n\t */\n\tvar $inherit = $thing.Object.inherit = function(obj, parent) {\n\t\tvar i,\n\t\t\tj,\n\t\t\tk,\n\t\t\tv,\n\t\t\tfunctString,\n\t\t\tsignature,\n\t\t\tsignatures = {},\n\t\t\tinherit = this.prototype\n\t\t\t;\n\t\tfunction ret() {\n\t\t\t/*jshint validthis:true */\n\t\t\t(this.init !== undefined)\n\t\t\t\t? this.init.apply(this, arguments)\n\t\t\t\t: undefined\n\t\t\t\t;\n\t\t}\n\t\tfunction replace() {\n\t\t\treturn (obj['$' + arguments[1]] !== undefined)\n\t\t\t\t? obj['$' + arguments[1]]\n\t\t\t\t: arguments[0]\n\t\t\t\t;\n\t\t}\n\t\tret.prototype = new this();\n\t\tret.prototype.constructor = ret;\n\t\tret.prototype.$vtable = (ret.prototype.$vtable !== undefined)\n\t\t\t? ret.prototype.$vtable.slice()\n\t\t\t: []\n\t\t\t;\n\t\tvar ordinal = ret.prototype.$vtable.push(obj) - 1,\n\t\t\tparentOrdinal = ret.prototype.$vtable.push(parent) - 1,\n\t\t\tsuperOrdinal = ret.prototype.$vtable.push(inherit) - 1\n\t\t\t;\n\t\tret.inherit = $inherit;\n\t\tfor (i in obj) {\n\t\t\tswitch(i) {\n\t\t\t\tcase '$vtable':\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '$signatures':\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '$owner':\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '$parent':\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase '$super':\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tv = obj[i];\n\t\t\tk = i.replace(/\\$\\((.+?)\\)/g, replace);\n\t\t\tj = k.substring(k.indexOf('.') + 1);\n\t\t\tif (typeof v !== 'function')\n\t\t\t\tret.prototype[k] = v;\n\t\t\telse {\n\t\t\t\tfunctString = v.toString();\n\t\t\t\tsignature = functString.match(/function[^(]*\\(([^)]*)\\)/);\n\t\t\t\t(typeof inherit[k] !== 'function')\n\t\t\t\t\t? (typeof inherit[j] !== 'function')\n\t\t\t\t\t\t? ret.prototype[k] = $thing.switchParentContext.apply(\n\t\t\t\t\t\t\tret.prototype,\n\t\t\t\t\t\t\t[\tfunctString,\n\t\t\t\t\t\t\t\tparentOrdinal,\n\t\t\t\t\t\t\t\tordinal,\n\t\t\t\t\t\t\t\ti\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: ret.prototype[k] = $thing.switchContext.apply(\n\t\t\t\t\t\t\tret.prototype,\n\t\t\t\t\t\t\t[\tfunctString,\n\t\t\t\t\t\t\t\tparentOrdinal,\n\t\t\t\t\t\t\t\tsuperOrdinal,\n\t\t\t\t\t\t\t\tordinal,\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\ti\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t)\n\t\t\t\t\t: ret.prototype[k] = $thing.switchContext.apply(\n\t\t\t\t\t\tret.prototype,\n\t\t\t\t\t\t[\tfunctString,\n\t\t\t\t\t\t\tparentOrdinal,\n\t\t\t\t\t\t\tsuperOrdinal,\n\t\t\t\t\t\t\tordinal,\n\t\t\t\t\t\t\tk,\n\t\t\t\t\t\t\ti\n\t\t\t\t\t\t]\n\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\t(signature !== null)\n\t\t\t\t\t? signatures[k] = (signature[1].length)\n\t\t\t\t\t\t? signature[1].split(/,\\s*/)\n\t\t\t\t\t\t: []\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t}\n\t\t}\n\t\tret.prototype.$owner = parent || ret.prototype.$owner;\n\t\tret.prototype.$signatures = $thing.merge(\n\t\t\tsignatures,\n\t\t\tret.prototype.$signatures\n\t\t);\n\t\treturn ret;\n\t};\n\n\t$thing.Base = $thing.Object.inherit({\n\n\t\t/**\n\t\t * @constructs Base\n\t\t * @mixes $thing.Object\n\t\t * @memberOf $thing\n\t\t */\n\t\tinit: function() {},\n\n\t\tgetName: function() {\n\t\t\treturn 'Base';\n\t\t},\n\n\t\t/**\n\t\t* Define an object property\n\t\t* @memberOf $thing\n\t\t* @method Base#property\n\t\t* @param {string} prop property name\n\t\t* @param {function} [cbGetter]\n\t\t* @param {function} [cbSetter]\n\t\t*/\n\t\tproperty: function(prop, cbGetter, cbSetter) {\n\t\t\tvar obj = {};\n\t\t\t(cbGetter)\n\t\t\t\t? obj.get = cbGetter\n\t\t\t\t: undefined\n\t\t\t\t;\n\t\t\t(cbSetter)\n\t\t\t\t? obj.set = cbSetter\n\t\t\t\t: undefined\n\t\t\t\t;\n\t\t\tObject.defineProperty(this, prop, obj);\n\t\t},\n\n\t\tbind: function(funct) {\n\t\t\tvar self = this;\n\t\t\treturn function() {\n\t\t\t\treturn funct.apply(self, arguments);\n\t\t\t};\n\t\t}\n\n\t});\n\n\t$thing.State = {\n\t\tEXPR_AND:\t\t1,\n\t\tEXPR_NOT:\t\t2,\n\t\tEXPR_OR:\t\t3,\n\t\tDEF_DESC:\t\t1,\n\t\tDEF_NAME:\t\t2,\n\t\tDEF_SOURCE:\t\t4,\n\t\tDEF_EXTENDS:\t16,\n\t\tDEF_IMPLEMENTS: 64,\n\t\tDEF_USES:\t\t128,\n\t\tDEF_META:\t\t256,\n\t\tDEF_NOP:\t\t512,\n\t\tDEF_END:\t\t1024,\n\t\tLIFE_INITIATED: 2048,\n\t\tLIFE_ACTIVE:\t4096,\n\t\tLIFE_WAITING:\t8192,\n\t\tLIFE_SUSPENDED: 16384,\n\t\tLIFE_DELETED:\t32768,\n\t\tLIFE_TRANSIT:\t65536,\n\t\tLIFE_BLOCKED:\t131072\n\t};\n\n\t$thing.Filter = {\n\t\tALL: \t\t\t1,\n\t\tFIRST: \t\t\t2,\n\t\tLAST: \t\t\t4\n\t};\n\n\t$thing.Definition = $thing.Base.inherit({\n\n\t\t_metaHandlers: {\n\t\t\tmobile: function() {\n\t\t\t\tthis._isMobile = true;\n\t\t\t},\n\t\t\tpassive: function() {\n\t\t\t\tthis._isPassive = true;\n\t\t\t},\n\t\t\tsingleton: function() {\n\t\t\t\tthis._singleton = this._singleton || this._source;\n\t\t\t},\n\t\t\tcatchall: function(catchall, methodName) {\n\t\t\t\tthis._substitute.$__catchall__ = methodName;\n\t\t\t}\n\t\t},\n\n\t\tgetName: function() {\n\t\t\treturn 'Definition';\n\t\t},\n\n\t\t/**\n\t\t* @constructs Definition\n\t\t* @mixes $thing.Base\n\t\t* @memberOf $thing\n\t\t* @param {object} parent\n\t\t* @param {object} super\n\t\t* @param {string} source\n\t\t* @param {string[]} stack\n\t\t*/\n\t\tinit: function(parent, _super, source, stack) {\n\t\t\tvar k,\n\t\t\t\titem,\n\t\t\t\tsearch,\n\t\t\t\tself = this\n\t\t\t\t;\n\t\t\tthis.$super();\n\t\t\tthis._state = $thing.State.DEF_DESC;\n\t\t\tthis._parent = parent;\n\t\t\tthis._children = [];\n\t\t\tthis._meta = [];\n\t\t\tthis._interfaces = [];\n\t\t\tthis._uses = [];\n\t\t\tthis._super = _super;\n\t\t\tthis._source = source;\n\t\t\tthis._refCount = 0;\n\t\t\tthis._isAgent = this._super === $thing.Agent;\n\t\t\tthis._isAbstract = false;\n\t\t\tthis._isPassive = false;\n\t\t\tthis._isMobile = false;\n\t\t\tthis._interfaces = [\n\t\t\t\t$thing.create64BitId(source, $thing.heap.length),\n\t\t\t\tsource\n\t\t\t];\n\t\t\tthis._substitute = {\n\t\t\t\t$id: this._interfaces[0],\n\t\t\t\t$source: source\n\t\t\t};\n\t\t\tthis.parseStack(stack);\n\t\t\tif (this._extends !== undefined) {\n\t\t\t\titem = $thing.search({_name: this._extends});\n\t\t\t\tif (item === undefined) throw(\n\t\t\t\t\t'DefinitionError: Super Class \\'' +\n\t\t\t\t\tthis._extends + '\\' is not defined'\n\t\t\t\t);\n\t\t\t\telse {\n\t\t\t\t\tthis._super = item._class;\n\t\t\t\t\tthis._singleton = item._singleton;\n\t\t\t\t\tfor(k = item._meta.length - 1; k > -1; k--)\n\t\t\t\t\t\tthis._meta.unshift(item._meta[k]);\n\t\t\t\t}\n\t\t\t\t(this._class === undefined)\n\t\t\t\t\t? this._class = {}\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t}\n\t\t\tthis._meta.forEach(function(item) {\n\t\t\t\tvar args = item.split(/ (.+)?/);\n\t\t\t\t(self._metaHandlers[args[0]] !== undefined)\n\t\t\t\t\t? self._metaHandlers[args[0]].apply(self, args)\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t});\n\t\t\tif (this._isAbstract)\n\t\t\t\tsearch = {\n\t\t\t\t\t_name: this._name,\n\t\t\t\t\t_source: this._source\n\t\t\t\t};\n\t\t\telse if (this._singleton !== undefined)\n\t\t\t\tsearch = {\n\t\t\t\t\t_name: this._name,\n\t\t\t\t\t_singleton: this._singleton\n\t\t\t\t};\n\t\t\tif (search !== undefined && (item = $thing.search(search))) {\n\t\t\t\tthis.refObject = item.bind(item.refObject);\n\t\t\t\tthis.property('class', function() {\n\t\t\t\t\treturn item._class;\n\t\t\t\t});\n\t\t\t\tthis.property('refCount', function() {\n\t\t\t\t\treturn item._refCount;\n\t\t\t\t});\n\t\t\t\tthis.property('isAbstract', function() {\n\t\t\t\t\treturn item._isAbstract;\n\t\t\t\t});\n\t\t\t\tthis.property('isPassive', function() {\n\t\t\t\t\treturn item._isPassive;\n\t\t\t\t});\n\t\t\t\tthis.property('instance', function() {\n\t\t\t\t\treturn item._instance;\n\t\t\t\t});\n\t\t\t\tthis.property('state', function() {\n\t\t\t\t\treturn item._state;\n\t\t\t\t});\n\t\t\t\tthis.property('name', function() {\n\t\t\t\t\treturn item._name;\n\t\t\t\t});\n\t\t\t\tthis.property('parent', function() {\n\t\t\t\t\treturn item._parent;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._childrenWrapper = {\n\t\t\t\t\tpush: this.bind(this._pushChild),\n\t\t\t\t\tforEach: this.bind(this._forEachChild)\n\t\t\t\t};\n\t\t\t\tObject.defineProperty(this._childrenWrapper, 'length', {\n\t\t\t\t\tget: this.bind(this._countChildren)\n\t\t\t\t});\n\t\t\t\t(this._factory !== undefined)\n\t\t\t\t\t? this._class = this._factory.apply(_global, this._uses)\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t\tif (this._class !== undefined) {\n\t\t\t\t\tfor(k in this._substitute)\n\t\t\t\t\t\tthis._class[k] = this._substitute[k]\n\t\t\t\t\t\t;\n\t\t\t\t\tvar interfaces = (this._name !== undefined)\n\t\t\t\t\t\t? this._interfaces.concat(this._name)\n\t\t\t\t\t\t: this._interfaces\n\t\t\t\t\t\t;\n\t\t\t\t\tthis._class.getInterfaces = function() {\n\t\t\t\t\t\treturn this.$super().concat(interfaces);\n\t\t\t\t\t};\n\t\t\t\t\tthis._class = this._super.inherit(\n\t\t\t\t\t\tthis._class,\n\t\t\t\t\t\tparent,\n\t\t\t\t\t\tthis._isMobile\n\t\t\t\t\t);\n\t\t\t\t\t$thing.attach(this);\n\t\t\t\t}\n\t\t\t\tthis.property('class', function() {\n\t\t\t\t\treturn this._class;\n\t\t\t\t});\n\t\t\t\tthis.property('refCount', function() {\n\t\t\t\t\treturn this._refCount;\n\t\t\t\t});\n\t\t\t\tthis.property('isAbstract', function() {\n\t\t\t\t\treturn this._isAbstract;\n\t\t\t\t});\n\t\t\t\tthis.property('isPassive', function() {\n\t\t\t\t\treturn this._isPassive;\n\t\t\t\t});\n\t\t\t\tthis.property('instance', function() {\n\t\t\t\t\treturn this._instance;\n\t\t\t\t});\n\t\t\t\tthis.property('state', function() {\n\t\t\t\t\treturn this._state;\n\t\t\t\t});\n\t\t\t\tthis.property('name', function() {\n\t\t\t\t\treturn this._name;\n\t\t\t\t});\n\t\t\t\tthis.property('parent', function() {\n\t\t\t\t\treturn this._parent;\n\t\t\t\t});\n\t\t\t}\n\n\t\t},\n\n\t\t_forEachChild: function(cb) {\n\t\t\tthis._children.forEach(function(args) {\n\t\t\t\t(args[0].getHeapId !== undefined)\n\t\t\t\t\t? cb.apply(undefined, args)\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t});\n\t\t},\n\n\t\t_pushChild: function(obj) {\n\t\t\tvar id = obj.getHeapId();\n\t\t\tfor(var i = 0; i < this._children.length; i++) {\n\t\t\t\tif (this._children[i][0].getHeapId === undefined)\n\t\t\t\t\tthis._children.splice(i, 1);\n\t\t\t\telse if (this._children[i][0].getHeapId() === id)\n\t\t\t\t\treturn this._children.length;\n\t\t\t}\n\t\t\treturn this._children.push(arguments);\n\t\t},\n\n\t\t_countChildren: function() {\n\t\t\tvar length = 0;\n\t\t\tthis._forEachChild(function(child) {\n\t\t\t\t(child.getRefCount())\n\t\t\t\t\t? length++\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t});\n\t\t\treturn length;\n\t\t},\n\n\t\tparseStack: function(stack) {\n\t\t\tvar item,\n\t\t\t\tmatch,\n\t\t\t\tself = this\n\t\t\t\t;\n\t\t\tfunction replace() {\n\t\t\t\treturn (arguments[1] === undefined)\n\t\t\t\t\t? stack.shift()\n\t\t\t\t\t: self._substitute['$' + arguments[1]] = stack.shift()\n\t\t\t\t\t;\n\t\t\t}\n\t\t\twhile(\t(this._state !== $thing.State.DEF_END) &&\n\t\t\t\t\t((item = stack.shift()) !== undefined)\n\t\t\t) {\n\t\t\t\tswitch(typeof item) {\n\t\t\t\t\tcase 'function':\n\t\t\t\t\t\tthis._state = $thing.State.DEF_END;\n\t\t\t\t\t\tthis._factory = item;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'object':\n\t\t\t\t\t\tthis._state = $thing.State.DEF_END;\n\t\t\t\t\t\tthis._class = item;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tswitch(item) {\n\t\t\t\t\tcase 'abstract':\n\t\t\t\t\t\tthis._isPassive = this._isAbstract = true;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'source':\n\t\t\t\t\t\tthis._state = $thing.State.DEF_SOURCE;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'extends':\n\t\t\t\t\t\tthis._state = $thing.State.DEF_EXTENDS;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'implements':\n\t\t\t\t\t\tthis._state = $thing.State.DEF_IMPLEMENTS;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'uses':\n\t\t\t\t\t\tthis._state = $thing.State.DEF_USES;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t(this._state === $thing.State.DEF_META || item.charAt(0) === '@')\n\t\t\t\t\t\t\t? this._state = $thing.State.DEF_META\n\t\t\t\t\t\t\t: (item.match(/ /))\n\t\t\t\t\t\t\t\t? this._state = $thing.State.DEF_DESC\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\tswitch(this._state) {\n\t\t\t\t\tcase $thing.State.DEF_DESC:\n\t\t\t\t\t\titem = item.replace(/\\$\\((.+?)\\)|\\$/g, replace);\n\t\t\t\t\t\titem = item.split(' @');\n\t\t\t\t\t\tstack = item[0].split(/ +/).filter(Boolean).concat(\n\t\t\t\t\t\t\t(item[1] !== undefined)\n\t\t\t\t\t\t\t\t? ['@' + item[1]].concat(stack)\n\t\t\t\t\t\t\t\t: stack\n\t\t\t\t\t\t);\n\t\t\t\t\t\t(this._name === undefined)\n\t\t\t\t\t\t\t? this._state = $thing.State.DEF_NAME\n\t\t\t\t\t\t\t: this._state = $thing.State.DEF_NOP\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.DEF_META:\n\t\t\t\t\t\titem = item.replace(/\\$\\((.+?)\\)|\\$/g, replace);\n\t\t\t\t\t\tif (item.charAt(item.length - 1) === '+') {\n\t\t\t\t\t\t\tstack = [\n\t\t\t\t\t\t\t\titem.slice(0, -1) + stack.shift()\n\t\t\t\t\t\t\t].concat(stack);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis._state = $thing.State.DEF_DESC;\n\t\t\t\t\t\t\tthis._meta.push(item.slice(1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.DEF_NAME:\n\t\t\t\t\t\tthis._name = item || this._name;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.DEF_SOURCE:\n\t\t\t\t\t\tthis._source = item || this._source;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.DEF_EXTENDS:\n\t\t\t\t\t\tthis._extends = item || this._extends;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.DEF_IMPLEMENTS:\n\t\t\t\t\t\t((match = item.match(/^\\/(.*?)\\/([gimy]*)$/)) !== null)\n\t\t\t\t\t\t\t? this._interfaces.push(\n\t\t\t\t\t\t\t\tnew RegExp(match[1], match[2])\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t: this._interfaces.push(item)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.DEF_USES:\n\t\t\t\t\t\tthis._uses.push(agent(item));\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tpatchObject: function(obj) {\n\t\t\tvar self = this;\n\t\t\tobj.refObject = this.bind(this.refObject);\n\t\t\tobj.getRefCount = function() {\n\t\t\t\treturn self._refCount;\n\t\t\t};\n\t\t\tobj.getHeapId = function() {\n\t\t\t\treturn self._id;\n\t\t\t};\n\t\t\tobj.getName = function() {\n\t\t\t\treturn self._name;\n\t\t\t};\n\t\t\tobj.getSource = function() {\n\t\t\t\treturn self._source;\n\t\t\t};\n\t\t\tobj.getChildren = function() {\n\t\t\t\treturn self._childrenWrapper;\n\t\t\t};\n\t\t\tobj.getState = function() {\n\t\t\t\treturn self._state;\n\t\t\t};\n\t\t\tobj.setState = function() {\n\t\t\t\tvar states = Array.prototype.slice.call(arguments, 0);\n\t\t\t\tstates.forEach(function(state) {\n\t\t\t\t\tself._state |= state;\n\t\t\t\t});\n\t\t\t\tthis.getChildren().forEach(function(child) {\n\t\t\t\t\tchild.setState(states);\n\t\t\t\t});\n\t\t\t};\n\t\t\tobj.unsetState = function() {\n\t\t\t\tvar states = Array.prototype.slice.call(arguments, 0);\n\t\t\t\tstates.forEach(function(state) {\n\t\t\t\t\tself._state &= ~state;\n\t\t\t\t});\n\t\t\t\tthis.getChildren().forEach(function(child) {\n\t\t\t\t\tchild.unsetState(states);\n\t\t\t\t});\n\t\t\t};\n\t\t\tobj.getMeta = function() {\n\t\t\t\treturn self._meta;\n\t\t\t};\n\t\t\tobj.isAbstract = function() {\n\t\t\t\treturn self._isAbstract;\n\t\t\t};\n\t\t\treturn obj;\n\t\t},\n\n\t\tunpatchObject: function(obj) {\n\t\t\tdelete obj.refObject;\n\t\t\tdelete obj.getRefCount;\n\t\t\tdelete obj.getHeapId;\n\t\t\tdelete obj.getName;\n\t\t\tdelete obj.getSource;\n\t\t\tdelete obj.getChildren;\n\t\t\tdelete obj.getState;\n\t\t\tdelete obj.setState;\n\t\t\tdelete obj.unsetState;\n\t\t\tdelete obj.getMeta;\n\t\t\tdelete obj.isAbstract;\n\t\t\treturn obj;\n\t\t},\n\n\t\trefObject: function(cb) {\n\t\t\tvar self = this;\n\t\t\tthis.parent.refObject(function(parent, cbRelease) {\n\t\t\t\tvar constructed;\n\t\t\t\tif (self._refCount)\n\t\t\t\t\tself._refCount++;\n\t\t\t\telse {\n\t\t\t\t\tself._refCount = constructed = 1;\n\t\t\t\t\tself._instance = self.patchObject(new self._class());\n\t\t\t\t\tself._instance.setState($thing.State.LIFE_INITIATED);\n\t\t\t\t}\n\t\t\t\tif (constructed && self._isAgent && !self._isAbstract)\n\t\t\t\t\tself._instance.setup();\n\t\t\t\tcb(\n\t\t\t\t\tself._instance,\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tif (self._isAgent && self._isPassive) return;\n\t\t\t\t\t\telse if (--self._refCount !== 0) cbRelease();\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (self._isAgent)\n\t\t\t\t\t\t\t\tself._instance.takedown(\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\tself._children = [];\n\t\t\t\t\t\t\t\t\t\tself.unpatchObject(self._instance);\n\t\t\t\t\t\t\t\t\t\tdelete self._instance;\n\t\t\t\t\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tself._children = [];\n\t\t\t\t\t\t\t\tself.unpatchObject(self._instance);\n\t\t\t\t\t\t\t\tdelete self._instance;\n\t\t\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t});\n\n\t/**\n\t * @class Delegate\n\t * @mixes $thing.Base\n\t * @memberOf $thing\n\t */\n\t$thing.Delegate = $thing.Base.inherit({\n\n\t\tgetName: function() {\n\t\t\treturn 'Delegate';\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Delegate#getInterfaces\n\t\t * @returns {string[]}\n\t\t */\n\t\tgetInterfaces: function() {\n\t\t\treturn [];\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Delegate#matchInterface\n\t\t * @param {string} pattern\n\t\t * @param {string} source\n\t\t * @returns {string}\n\t\t */\n\t\tmatchInterface: function(pattern) {\n\t\t\tvar interfaces = this.getInterfaces();\n\t\t\tfor(var i = 0; i < interfaces.length; i++)\n\t\t\t\tif (\n\t\t\t\t\t(interfaces[i] instanceof RegExp)\n\t\t\t\t\t\t? pattern.match(interfaces[i]) !== null\n\t\t\t\t\t\t: interfaces[i] === pattern\n\t\t\t\t) break;\n\t\t\treturn interfaces[i];\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Delegate#refObject\n\t\t */\n\t\trefObject: function(cb) {\n\t\t\tcb(this, function(){});\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Delegate#dispatch\n\t\t * @param {object} call\n\t\t */\n\t\tdispatch: function(call, cb) {\n\t\t\tvar method,\n\t\t\t\tsignature\n\t\t\t\t;\n\t\t\tcb = cb || function() {};\n\t\t\tif (call.method.charAt(0) === '$') return cb();\n\t\t\t(this[method = call.interface + '.' + call.method] === undefined)\n\t\t\t\t? (this[method = call.method] === undefined)\n\t\t\t\t\t? method = undefined\n\t\t\t\t\t: undefined\n\t\t\t\t: undefined\n\t\t\t\t;\n\t\t\t(\tmethod === undefined ||\n\t\t\t\t(signature = this.$signatures[method]) === undefined ||\n\t\t\t\tsignature[signature.length - 1].charAt(0) !== '$' ||\n\t\t\t\tsignature.length !== call.args.length + 1\n\t\t\t)\n\t\t\t\t? (\tthis[method = this.$__catchall__] === undefined ||\n\t\t\t\t\t(signature = this.$signatures[method]) === undefined ||\n\t\t\t\t\tsignature[1].charAt(0) !== '$' ||\n\t\t\t\t\tsignature.length !== 2\n\t\t\t\t)\n\t\t\t\t\t? cb()\n\t\t\t\t\t: this[this.$__catchall__].apply(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t[call.args, cb]\n\t\t\t\t\t)\n\t\t\t\t: this[method].apply(\n\t\t\t\t\tthis,\n\t\t\t\t\tcall.args.concat(cb)\n\t\t\t\t)\n\t\t\t\t;\n\t\t}\n\n\t});\n\n\t$thing.Pattern = $thing.Delegate.inherit({\n\n\t\tgetName: function() {\n\t\t\treturn 'Pattern';\n\t\t},\n\n\t\t/**\n\t\t * @constructs Pattern\n\t\t * @mixes $thing.Delegate\n\t\t * @memberOf $thing\n\t\t * @param {(string|string[])} pattern\n\t\t * @param {string} source\n\t\t */\n\t\tinit: function(pattern, source) {\n\t\t\tthis.$super();\n\t\t\tthis._pattern = pattern;\n\t\t\tthis.property('source', function() {\n\t\t\t\treturn source;\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Pattern#toArray\n\t\t * @returns {string[]}\n\t\t */\n\t\ttoArray: function() {\n\t\t\treturn (this._pattern instanceof Array)\n\t\t\t\t? this._pattern\n\t\t\t\t: [[this._pattern]]\n\t\t\t\t;\n\t\t}\n\n\t});\n\n\t/**\n\t * @class Agent\n\t * @mixes $thing.Delegate\n\t * @memberOf $thing\n\t */\n\t$thing.Agent = $thing.Delegate.inherit({\n\n\t\tgetName: function() {\n\t\t\treturn 'Agent';\n\t\t},\n\n\t\tgetInterfaces: function() {\n\t\t\treturn ['Agent'];\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#setup\n\t\t */\n\t\tsetup: function(cb) {\n\t\t\tthis.setState($thing.State.LIFE_ACTIVE);\n\t\t\tthis.doActivate(cb);\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#takedown\n\t\t */\n\t\ttakedown: function(cb) {\n\t\t\tthis.doDelete(cb);\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#doActivate\n\t\t */\n\t\tdoActivate: function(cb) {\n\t\t\tthis.unsetState($thing.State.LIFE_SUSPENDED);\n\t\t\t//(cb || function(){})();\n\t\t\tif (cb) cb();\n\t\t\tagent();\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#doDelete\n\t\t */\n\t\tdoDelete: function(cb) {\n\t\t\tthis.setState($thing.State.LIFE_DELETED);\n\t\t\t//(cb || function(){})();\n\t\t\tif (cb) cb();\n\t\t\tagent();\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#doSuspend\n\t\t */\n\t\tdoSuspend: function(cb) {\n\t\t\tthis.setState($thing.State.LIFE_SUSPENDED);\n\t\t\t//(cb || function(){})();\n\t\t\tif (cb) cb();\n\t\t\tagent();\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#doWait\n\t\t */\n\t\tdoWait: function(cb) {\n\t\t\tthis.setState($thing.State.LIFE_WAITING);\n\t\t\t//(cb || function(){})();\n\t\t\tif (cb) cb();\n\t\t\tagent();\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#doWake\n\t\t */\n\t\tdoWake: function(cb) {\n\t\t\tthis.unsetState($thing.State.LIFE_WAITING);\n\t\t\t//(cb || function(){})();\n\t\t\tif (cb) cb();\n\t\t\tagent();\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#addBehaviour\n\t\t * @param {*}\n\t\t * @returns {$thing.Behaviour}\n\t\t */\n\t\taddBehaviour: function() {\n\t\t\tvar obj,\n\t\t\t\treset,\n\t\t\t\tself = this,\n\t\t\t\targs = Array.prototype.slice.call(arguments, 0)\n\t\t\t\t;\n\t\t\tvar def = new $thing.Definition(\n\t\t\t\t\tthis,\n\t\t\t\t\t$thing.Behaviour,\n\t\t\t\t\t$thing.getBacktrace(1)[0],\n\t\t\t\t\targs\n\t\t\t\t)\n\t\t\t\t;\n\t\t\tif (def.class !== undefined) {\n\t\t\t\tvar funct = function() {\n\t\t\t\t\t(!def.refCount)\n\t\t\t\t\t\t? def.refObject(function(instance, cbRelease) {\n\t\t\t\t\t\t\t$thing.attach(def);\n\t\t\t\t\t\t\tobj = instance;\n\t\t\t\t\t\t\tself.getChildren().push(obj, cbRelease);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t: obj = def.instance\n\t\t\t\t\t\t;\n\t\t\t\t\tobj.unsetState(\n\t\t\t\t\t\t$thing.State.LIFE_WAITING |\n\t\t\t\t\t\t$thing.State.LIFE_SUSPENDED |\n\t\t\t\t\t\t$thing.State.LIFE_DELETED |\n\t\t\t\t\t\t$thing.State.LIFE_TRANSIT |\n\t\t\t\t\t\t$thing.State.LIFE_BLOCKED\n\t\t\t\t\t);\n\t\t\t\t\tobj.setState(\n\t\t\t\t\t\tself.getState() |\n\t\t\t\t\t\t$thing.State.LIFE_ACTIVE\n\t\t\t\t\t);\n\t\t\t\t\tagent();\n\t\t\t\t};\n\t\t\t\tfunct();\n\t\t\t\treset = obj.reset;\n\t\t\t\tobj.reset = function() {\n\t\t\t\t\tfunct();\n\t\t\t\t\treset.apply(obj, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * @memberOf $thing\n\t\t * @method Agent#removeBehaviour\n\t\t * @param {string|$thing.Behaviour}\n\t\t */\n\t\tremoveBehaviour: function() {\n\t\t\tvar objs = [],\n\t\t\t\tchildren = this.getChildren()\n\t\t\t\t;\n\t\t\tif (\ttypeof arguments[0] === 'object' &&\n\t\t\t\t\targuments[0].getHeapId !== undefined\n\t\t\t) {\n\t\t\t\tvar id = arguments[0].getHeapId();\n\t\t\t\tchildren.forEach(function(obj, cbRelease) {\n\t\t\t\t\tif (obj.getHeapId() === id) {\n\t\t\t\t\t\tobj.setState($thing.State.LIFE_DELETED);\n\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\tobjs.push(obj);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments, 0),\n\t\t\t\t\tdef = new $thing.Definition(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t$thing.Behaviour,\n\t\t\t\t\t\t$thing.getBacktrace(1)[0],\n\t\t\t\t\t\targs\n\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\tchildren.forEach(function(obj, cbRelease) {\n\t\t\t\t\tif (obj.getName() === def.name) {\n\t\t\t\t\t\tobj.setState($thing.State.LIFE_DELETED);\n\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\tobjs.push(obj);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn objs;\n\t\t}\n\n\t});\n\n\t/**\n\t * @class Behaviour\n\t * @mixes $thing.Delegate\n\t * @memberOf $thing\n\t */\n\t$thing.Behaviour = $thing.Delegate.inherit({\n\n\t\tgetName: function() {\n\t\t\treturn 'Behaviour';\n\t\t},\n\n\t\tgetInterfaces: function() {\n\t\t\treturn ['Behaviour'];\n\t\t},\n\n\t\tdone: function() {\n\t\t\treturn false;\n\t\t},\n\n\t\taction: function($cb) {\n\t\t\t(this.done())\n\t\t\t\t? this.$owner.removeBehaviour(this)\n\t\t\t\t: undefined\n\t\t\t\t;\n\t\t\tif ($cb) $cb();\n\t\t},\n\n\t\tblock: function(cb) {\n\t\t\tthis.setState($thing.State.LIFE_BLOCKED);\n\t\t\tif (cb) cb();\n\t\t},\n\n\t\trestart: function(cb) {\n\t\t\tthis.unsetState($thing.State.LIFE_BLOCKED);\n\t\t\tif (cb) cb();\n\t\t},\n\n\t\treset: function(cb) {\n\t\t\tif (cb) cb();\n\t\t}\n\n\t});\n\n\t$thing.Selector = $thing.Base.inherit({\n\n\t\tgetName: function() {\n\t\t\treturn 'Selector';\n\t\t},\n\n\t\t/**\n\t\t * @constructs Selector\n\t\t * @mixes $thing.Base\n\t\t * @memberOf $thing\n\t\t * @param {(string|string[]|$thing.Pattern)} pattern\n\t\t * @param {string} source\n\t\t * @param {boolean} [includePassive=true]\n\t\t */\n\t\tinit: function(pattern, source, includePassive) {\n\t\t\tvar i,\n\t\t\t\tinclude,\n\t\t\t\tdef\n\t\t\t\t;\n\t\t\tthis.$super();\n\t\t\tthis._source = source;\n\t\t\tthis._exprs = [];\n\t\t\tthis._selection = [];\n\t\t\tthis._callbacks = [];\n\t\t\tif (pattern instanceof $thing.Pattern) {\n\t\t\t\tthis._source = pattern.source;\n\t\t\t\tpattern = pattern.toArray();\n\t\t\t}\n\t\t\telse if (typeof pattern === 'string') {\n\t\t\t\tvar expr = {\n\t\t\t\t\tand: {},\n\t\t\t\t\tnot: {}\n\t\t\t\t};\n\t\t\t\texpr.and[pattern] = true;\n\t\t\t\tthis._exprs.push(expr);\n\t\t\t}\n\t\t\tif (pattern instanceof Array) {\n\t\t\t\tfor(i = 0; i < pattern.length; i++) {\n\t\t\t\t\tthis.parseStack(pattern[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tincludePassive =\n\t\t\t\t(includePassive === undefined)\n\t\t\t\t\t? true\n\t\t\t\t\t: includePassive\n\t\t\t\t\t;\n\t\t\tfor(i = 0; i < $thing.heap.length; i++) {\n\t\t\t\tdef = $thing.heap[i];\n\t\t\t\tinclude = (def.isPassive)\n\t\t\t\t\t? (def.isPassive & includePassive) &&\n\t\t\t\t\t\tdef.state < $thing.State.LIFE_SUSPENDED\n\t\t\t\t\t: (includePassive)\n\t\t\t\t\t\t? def.state < $thing.State.LIFE_SUSPENDED\n\t\t\t\t\t\t: def.state < $thing.State.LIFE_WAITING\n\t\t\t\t\t;\n\t\t\t\t(\t!def.isAbstract &&\n\t\t\t\t\tdef.refCount > 0 &&\n\t\t\t\t\tdef.state & $thing.State.LIFE_ACTIVE &&\n\t\t\t\t\tinclude\n\t\t\t\t)\n\t\t\t\t\t? def.refObject(this.bind(this.matchObject))\n\t\t\t\t\t: undefined\n\t\t\t\t\t;\n\t\t\t}\n\t\t\tthis.property('length', function() {\n\t\t\t\treturn this._selection.length;\n\t\t\t});\n\t\t},\n\n\t\tparseStack: function(stack) {\n\t\t\tvar k,\n\t\t\t\titem,\n\t\t\t\tstate = $thing.State.EXPR_AND,\n\t\t\t\texpr = {\n\t\t\t\t\tand: {},\n\t\t\t\t\tnot: {}\n\t\t\t\t}\n\t\t\t\t;\n\t\t\twhile((item = stack.shift()) !== undefined) {\n\t\t\t\tswitch(item) {\n\t\t\t\t\tcase 'and':\n\t\t\t\t\t\tstate = $thing.State.EXPR_AND;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'not':\n\t\t\t\t\t\tstate = $thing.State.EXPR_NOT;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase 'or':\n\t\t\t\t\t\tstate = $thing.State.EXPR_OR;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tswitch(state) {\n\t\t\t\t\tcase $thing.State.EXPR_AND:\n\t\t\t\t\t\texpr.and[item] = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.EXPR_NOT:\n\t\t\t\t\t\texpr.not[item] = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $thing.State.EXPR_OR:\n\t\t\t\t\t\tfor (k in expr.and) {\n\t\t\t\t\t\t\tthis._exprs.push(expr);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\texpr = {\n\t\t\t\t\t\t\tand: {},\n\t\t\t\t\t\t\tnot: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t\texpr.and[item] = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (k in expr.and) {\n\t\t\t\tthis._exprs.push(expr);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tmatchObject: function(obj, cbRelease) {\n\t\t\tvar k,\n\t\t\t\tmatch;\n\t\t\tfor (var i = 0; i < this._exprs.length; i++) {\n\t\t\t\tvar m,\n\t\t\t\t\texpr = this._exprs[i]\n\t\t\t\t\t;\n\t\t\t\tfor(k in expr.and)\n\t\t\t\t\tif ((m = obj.matchInterface(k, this._source)) !== undefined)\n\t\t\t\t\t\tmatch = match || m;\n\t\t\t\t\telse {\n\t\t\t\t\t\tmatch = undefined;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tif (match === undefined)\n\t\t\t\t\tcontinue;\n\t\t\t\tfor(k in expr.not)\n\t\t\t\t\tif (obj.matchInterface(k, this._source)) {\n\t\t\t\t\t\tmatch = undefined;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\tif (match !== undefined)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (match === undefined)\n\t\t\t\tcbRelease();\n\t\t\telse {\n\t\t\t\tthis._callbacks.push(cbRelease);\n\t\t\t\tthis._selection.push({match: match, obj: obj});\n\t\t\t}\n\t\t},\n\n\t\tdispatch: function(call, cbItem, cbDone) {\n\t\t\tasync.setImmediate(this.bind(function() {\n\n\t\t\t\tif (\tcall.filters & $thing.Filter.FIRST &&\n\t\t\t\t\t\tthis._selection.length > 0\n\t\t\t\t) {\n\n\t\t\t\t\tthis._selection[0].obj.dispatch(\n\t\t\t\t\t\t{\tinterface: this._selection[0].match,\n\t\t\t\t\t\t\tmethod: call.method,\n\t\t\t\t\t\t\targs: call.args\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.bind(function() {\n\t\t\t\t\t\t\treturn cbItem.apply(\n\t\t\t\t\t\t\t\tthis._selection[0].obj,\n\t\t\t\t\t\t\t\tArray.prototype.slice.call(\n\t\t\t\t\t\t\t\t\targuments,\n\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t).concat(cbDone)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t}\n\t\t\t\telse if (\tcall.filters & $thing.Filter.LAST &&\n\t\t\t\t\t\t\tthis._selection.length > 0\n\t\t\t\t) {\n\t\t\t\t\tvar i = this._selection.length - 1;\n\n\t\t\t\t\tthis._selection[i].obj.dispatch(\n\t\t\t\t\t\t{\tinterface: this._selection[i].match,\n\t\t\t\t\t\t\tmethod: call.method,\n\t\t\t\t\t\t\targs: call.args\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.bind(function() {\n\t\t\t\t\t\t\treturn cbItem.apply(\n\t\t\t\t\t\t\t\tthis._selection[i].obj,\n\t\t\t\t\t\t\t\tArray.prototype.slice.call(\n\t\t\t\t\t\t\t\t\targuments,\n\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t).concat(cbDone)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t}\n\t\t\t\telse if (\tcall.filters & $thing.Filter.ALL &&\n\t\t\t\t\t\t\tthis._selection.length > 0\n\t\t\t\t) {\n\n\t\t\t\t\tasync.each(\n\t\t\t\t\t\tthis._selection,\n\t\t\t\t\t\tfunction(item, cbNext) {\n\t\t\t\t\t\t\titem.obj.dispatch(\n\t\t\t\t\t\t\t\t{\tinterface: item.match,\n\t\t\t\t\t\t\t\t\tmethod: call.method,\n\t\t\t\t\t\t\t\t\targs: call.args\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\treturn cbItem.apply(\n\t\t\t\t\t\t\t\t\t\titem.obj,\n\t\t\t\t\t\t\t\t\t\tArray.prototype.slice.call(\n\t\t\t\t\t\t\t\t\t\t\targuments,\n\t\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t).concat(cbNext)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcbDone\n\t\t\t\t\t);\n\t\t\t\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tcbDone();\n\n\t\t\t\t}\n\n\t\t\t}));\n\t\t},\n\n\t\trelease: function() {\n\t\t\tfor(var i = 0; i < this._callbacks.length; i++)\n\t\t\t\tthis._callbacks[i]();\n\t\t\tthis._callbacks = [];\n\t\t\tthis._selection = [];\n\t\t}\n\n\t});\n\n\t$thing.WAKE_MIN_PERIOD = 500;\n\t$thing.nextWakeTime = Date.now();\n\t$thing.isActionTaskQueued = false;\n\n\t$thing.wakeTask = function() {\n\t\tvar now = Date.now();\n\n\t\tif (now >= $thing.nextWakeTime) {\n\n\t\t\tvar selector = new $thing.Selector(\n\t\t\t\t\t[['Behaviour', 'and', 'Waker']], \n\t\t\t\t\t'$thing', \n\t\t\t\t\tfalse\n\t\t\t\t)\n\t\t\t\t;\n\n\t\t\tif (selector.length === 0) {\n\t\t\t\tselector.release();\n\t\t\t\tselector = undefined;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tselector.dispatch(\n\t\t\t\t\t{\tfilters: $thing.Filter.ALL,\n\t\t\t\t\t\tmethod: 'action',\n\t\t\t\t\t\targs: []\n\t\t\t\t\t},\n\t\t\t\t\tfunction(cbNext) {\n\t\t\t\t\t\tcbNext();\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tselector.release();\n\t\t\t\t\t\tselector = undefined;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t$thing.lastWakeTime = now % $thing.WAKE_MIN_PERIOD + now;\n\t\t}\n\t};\n\n\t$thing.enqueueActionTask = function() {\n\t\tif ($thing.isActionTaskQueued) return;\n\t\t$thing.isActionTaskQueued = true;\n\n\t\tasync.setImmediate(function() {\n\t\t\tvar selector = new $thing.Selector(\n\t\t\t\t\t[['Behaviour', 'not', 'Waker']], \n\t\t\t\t\t'$thing', \n\t\t\t\t\tfalse\n\t\t\t\t)\n\t\t\t\t;\n\t\t\n\t\t\tif (selector.length === 0) {\n\t\t\t\tselector.release();\n\t\t\t\tselector = undefined;\n\t\t\t\t$thing.isActionTaskQueued = false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tselector.dispatch(\n\t\t\t\t\t{\tfilters: $thing.Filter.ALL,\n\t\t\t\t\t\tmethod: 'action',\n\t\t\t\t\t\targs: []\n\t\t\t\t\t},\n\t\t\t\t\tfunction(cbNext) {\n\t\t\t\t\t\tcbNext();\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tselector.release();\n\t\t\t\t\t\tselector = undefined;\n\t\t\t\t\t\t$thing.isActionTaskQueued = false;\n\t\t\t\t\t\t$thing.enqueueActionTask();\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t});\n\n\t};\n\n\tfunction cbBuilder(self, args, cbDone) {\n\t\tcbDone = cbDone || function(){};\n\t\treturn function() {\n\t\t\tvar self = this,\n\t\t\t\targs = arguments\n\t\t\t\t;\n\t\t\tagent();\n\t\t\treturn (!args.length)\n\t\t\t\t? cbDone()\n\t\t\t\t: function() {\n\t\t\t\t\tvar cbObj = (arguments.length)\n\t\t\t\t\t\t? arguments\n\t\t\t\t\t\t: [$thing.Container]\n\t\t\t\t\t\t;\n\t\t\t\t\tasync.setImmediate(function() {\n\t\t\t\t\t\tagent(self)\n\t\t\t\t\t\t\t.apply(_global, args)\n\t\t\t\t\t\t\t.apply(_global, cbObj)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tcbDone();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t;\n\t\t}.apply(self, args);\n\t}\n\n\t/**\n\t * @method agent\n\t * @param {*}\n\t */\n\tvar agent = _global.agent = function() {\n\t\tvar def,\n\t\t\tsource,\n\t\t\tselector,\n\t\t\tfilter,\n\t\t\tpattern,\n\t\t\tselects,\n\t\t\tcallChain,\n\t\t\trefCount = 0\n\t\t\t;\n\n\t\tswitch(arguments.length) {\n\t\t\tcase 0:\n\t\t\t\t$thing.wakeTask();\n\t\t\t\treturn $thing.enqueueActionTask();\n\t\t\tcase 1:\n\t\t\t\tif (arguments[0] instanceof $thing.Pattern) {\n\t\t\t\t\tselector = new $thing.Selector(pattern = arguments[0]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse if (\ttypeof arguments[0] === 'object' &&\n\t\t\t\t\t\t\targuments[0].getInterfaces !== undefined\n\t\t\t\t) {\n\t\t\t\t\tselector = arguments[0];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tdefault:\n\t\t\t\tvar args = Array.prototype.slice.call(arguments, 0);\n\t\t\t\tdef = new $thing.Definition(\n\t\t\t\t\t$thing.Container,\n\t\t\t\t\t$thing.Agent,\n\t\t\t\t\t(source = $thing.getBacktrace(1)[0]),\n\t\t\t\t\targs\n\t\t\t\t);\n\t\t\t\tif (def.class !== undefined)\n\t\t\t\t\treturn def.refObject(\n\t\t\t\t\t\tfunction(obj, cbRelease){\n\t\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\telse {\n\t\t\t\t\tselects = [];\n\t\t\t\t\t$thing.searchMeta(def, 'select', function() {\n\t\t\t\t\t\tselects.push(Array.prototype.slice.call(arguments, 0));\n\t\t\t\t\t});\n\t\t\t\t\tselector = new $thing.Selector(\n\t\t\t\t\t\tpattern = (selects.length)\n\t\t\t\t\t\t\t? selects\n\t\t\t\t\t\t\t: def.name,\n\t\t\t\t\t\tsource\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t}\n\n\t\tfilter = function(filters, callArgs) {\t\t\t\n\t\t\treturn function() {\n\t\t\t\tvar obj,\n\t\t\t\t\targs = Array.prototype.slice.call(arguments, 0)\n\t\t\t\t\t;\n\t\t\t\t\n\t\t\t\tswitch(arguments.length) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tobj = $thing.Container;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tif (typeof arguments[0] === 'object' &&\n\t\t\t\t\t\t\targuments[0].getInterfaces !== undefined\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tobj = arguments[0];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/* falls through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvar source = $thing.getBacktrace(1)[0],\n\t\t\t\t\t\t\tdef = new $thing.Definition(\n\t\t\t\t\t\t\t\t$thing.Container,\n\t\t\t\t\t\t\t\t$thing.Agent,\n\t\t\t\t\t\t\t\tsource,\n\t\t\t\t\t\t\t\targs\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tif (def.class !== undefined) obj = def;\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tselects = [];\n\t\t\t\t\t\t\t$thing.searchMeta(def, 'select', function() {\n\t\t\t\t\t\t\t\tselects.push(Array.prototype.slice.call(arguments, 0));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tobj = new $thing.Pattern(\n\t\t\t\t\t\t\t\t(selects.length)\n\t\t\t\t\t\t\t\t\t? selects\n\t\t\t\t\t\t\t\t\t: def.name,\n\t\t\t\t\t\t\t\tsource\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tobj.refObject(function(obj, cbRelease) {\n\n\t\t\t\t\trefCount++;\n\n\t\t\t\t\t(pattern !== undefined)\n\t\t\t\t\t\t? selector.dispatch(\n\t\t\t\t\t\t\t{\tfilters: filters,\n\t\t\t\t\t\t\t\tmethod: callArgs[0],\n\t\t\t\t\t\t\t\targs: callArgs.slice(1)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\treturn cbBuilder(\n\t\t\t\t\t\t\t\t\tobj,\n\t\t\t\t\t\t\t\t\tArray.prototype.slice.call(\n\t\t\t\t\t\t\t\t\t\targuments,\n\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\targuments.length - 1\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\targuments[arguments.length - 1]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\tif (--refCount === 0) {\n\t\t\t\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\t\t\t\tselector.release();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: selector.dispatch(\n\t\t\t\t\t\t\t{\tfilters: filters,\n\t\t\t\t\t\t\t\tmethod: callArgs[0],\n\t\t\t\t\t\t\t\targs: callArgs.slice(1)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\treturn cbBuilder(\n\t\t\t\t\t\t\t\t\tobj,\n\t\t\t\t\t\t\t\t\targuments,\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\tif (--refCount === 0) {\n\t\t\t\t\t\t\t\t\t\t\tcbRelease();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t\t;\n\t\t\t\t});\n\n\t\t\t\treturn callChain;\n\t\t\t};\n\t\t};\n\n\t\tcallChain = function() {\n\t\t\treturn filter(\n\t\t\t\t$thing.Filter.ALL, \n\t\t\t\tArray.prototype.slice.call(arguments, 0)\n\t\t\t);\n\t\t};\n\n\t\tcallChain.all = callChain;\n\n\t\tcallChain.first = function() {\n\t\t\treturn filter(\n\t\t\t\t$thing.Filter.FIRST, \n\t\t\t\tArray.prototype.slice.call(arguments, 0)\n\t\t\t);\n\t\t};\n\n\t\tcallChain.last = function() {\n\t\t\treturn filter(\n\t\t\t\t$thing.Filter.LAST, \n\t\t\t\tArray.prototype.slice.call(arguments, 0)\n\t\t\t);\n\t\t};\n\n\t\treturn callChain;\n\t};\n\n\t(_module !== undefined)\n\t\t? _module.exports = agent\n\t\t: _global.agent = agent\n\t\t;\n\n\t/**\n\t * @class Container\n\t * @mixes $thing.Agent\n\t * @memberOf $thing\n\t */\n\t$thing.Container = new ($thing.Agent.inherit({\n\t\tgetName: function() {\n\t\t\treturn 'Container';\n\t\t},\n\t\tgetInterfaces: function() {\n\t\t\treturn ['Container'];\n\t\t},\n\t\tsetup: undefined,\n\t\ttakedown: undefined,\n\t\taddBehaviour: undefined,\n\t\tremoveBehaviour: undefined\n\t}))();\n\n\tagent({\n\t\tsetup: function(cb) {\n\t\t\tthis.$super(cb);\n\n\t\t\t/**\n\t\t\t * @class Done\n\t\t\t * @mixes $thing.Behaviour\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'@passive',\n\t\t\t\t'@catchall catchAll',\n\t\t\t\t'Done', {\n\t\t\t\t\tcatchAll: function(args, $cb) {\n\t\t\t\t\t\t$cb('done')();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Error\n\t\t\t * @mixes $thing.Behaviour\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'@passive',\n\t\t\t\t'@catchall catchAll',\n\t\t\t\t'Error', {\n\t\t\t\t\tcatchAll: function(args, $cb) {\n\t\t\t\t\t\t$cb('doneWithError', -1)();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Flow\n\t\t\t * @abstract\n\t\t\t * @mixes $thing.Behaviour\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'abstract Flow', {\n\t\t\t\t\t/**\n\t\t\t\t\t * @method Flow#getFlow\n\t\t\t\t\t * @returns {function[]}\n\t\t\t\t\t */\n\t\t\t\t\tgetFlow: function() {\n\t\t\t\t\t\tvar self = this,\n\t\t\t\t\t\t\treset = this.reset,\n\t\t\t\t\t\t\tgetFlow = this.getFlow,\n\t\t\t\t\t\t\tmethods = [],\n\t\t\t\t\t\t\tnames = [],\n\t\t\t\t\t\t\targs = Array.prototype.slice.call(arguments, 0)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\targs.forEach(function(item) {\n\t\t\t\t\t\t\t(names.indexOf(item) === -1)\n\t\t\t\t\t\t\t\t? names.push(item)\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$thing.searchMeta(this, 'flow', function() {\n\t\t\t\t\t\t\tArray.prototype.slice.call(arguments, 0).forEach(\n\t\t\t\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\t\t\t\t(names.indexOf(item) === -1)\n\t\t\t\t\t\t\t\t\t\t? names.push(item)\n\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnames.forEach(function(item) {\n\t\t\t\t\t\t\t(\tself.$signatures[item] !== undefined &&\n\t\t\t\t\t\t\t\tself.$signatures[item]\n\t\t\t\t\t\t\t\t\t[self.$signatures[item].length - 1]\n\t\t\t\t\t\t\t\t\t\t.charAt(0) === '$'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t? methods.push(function() {\n\t\t\t\t\t\t\t\t\tvar cbYield = arguments[arguments.length - 1],\n\t\t\t\t\t\t\t\t\t\targs = Array.prototype.slice.call(\n\t\t\t\t\t\t\t\t\t\t\targuments,\n\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\targuments.length - 1\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\targs.push(function() {\n\t\t\t\t\t\t\t\t\t\tvar args = arguments;\n\t\t\t\t\t\t\t\t\t\treturn (args.length === 0)\n\t\t\t\t\t\t\t\t\t\t\t? cbYield()\n\t\t\t\t\t\t\t\t\t\t\t: function() {\n\t\t\t\t\t\t\t\t\t\t\t\tagent(new ($thing.Agent.inherit({\n\t\t\t\t\t\t\t\t\t\t\t\t\tdone: function($cb) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar i = names.indexOf(item);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnames.splice(i, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmethods.splice(i, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$cb();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcbYield();\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\tyield: function($cb) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$cb();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcbYield();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}))())\n\t\t\t\t\t\t\t\t\t\t\t\t.apply(_global, args)\n\t\t\t\t\t\t\t\t\t\t\t\t.apply(_global, [])\n\t\t\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tself[item].apply(self, args);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.reset = function(cb) {\n\t\t\t\t\t\t\tthis.getFlow = getFlow;\n\t\t\t\t\t\t\treturn reset.apply(this, [cb]);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.getFlow = function() {\n\t\t\t\t\t\t\treturn methods;\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn methods;\n\t\t\t\t\t},\n\t\t\t\t\taction: function($cb) {\n\t\t\t\t\t\t(!this.getFlow().length)\n\t\t\t\t\t\t\t? this.done = function() {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\tthis.$super($cb);\n\t\t\t\t\t},\n\t\t\t\t\tdone: function() {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Series\n\t\t\t * @mixes Flow\n\t\t\t * @abstract\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'abstract Series extends Flow', {\n\t\t\t\t\taction: function($cb) {\n\t\t\t\t\t\tasync.series(\n\t\t\t\t\t\t\tthis.getFlow(),\n\t\t\t\t\t\t\tthis.bind(function() {\n\t\t\t\t\t\t\t\tthis.$super($cb);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Parallel\n\t\t\t * @mixes Flow\n\t\t\t * @abstract\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'abstract Parallel extends Flow', {\n\t\t\t\t\taction: function($cb) {\n\t\t\t\t\t\tasync.parallel(\n\t\t\t\t\t\t\tthis.getFlow(),\n\t\t\t\t\t\t\tthis.bind(function() {\n\t\t\t\t\t\t\t\tthis.$super($cb);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Queue\n\t\t\t * @mixes Flow\n\t\t\t * @abstract\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'abstract Queue extends Flow', {\n\t\t\t\t\t/**\n\t\t\t\t\t * @method Queue#getQueue\n\t\t\t\t\t */\n\t\t\t\t\tgetQueue: function() {\n\t\t\t\t\t\tvar self = this,\n\t\t\t\t\t\t\tconcurrency = 1,\n\t\t\t\t\t\t\tlimit = 0,\n\t\t\t\t\t\t\tfuncts = [],\n\t\t\t\t\t\t\tactive = 0,\n\t\t\t\t\t\t\tpaused = false\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t$thing.searchMeta(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'concurrency',\n\t\t\t\t\t\t\t'int',\n\t\t\t\t\t\t\tfunction(value) {\n\t\t\t\t\t\t\t\tconcurrency = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\t$thing.searchMeta(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'limit',\n\t\t\t\t\t\t\t'int',\n\t\t\t\t\t\t\tfunction(value) {\n\t\t\t\t\t\t\t\tlimit = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tvar queue = {\n\t\t\t\t\t\t\tpush: function(item, cbItem) {\n\t\t\t\t\t\t\t\tif (limit && functs.length > limit - 1) {\n\t\t\t\t\t\t\t\t\tcbItem(-1);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!paused)\n\t\t\t\t\t\t\t\t\tself.unsetState($thing.State.LIFE_WAITING);\n\t\t\t\t\t\t\t\tfuncts.push(function(cbDone) {\n\t\t\t\t\t\t\t\t\tvar flow = self.getFlow();\n\t\t\t\t\t\t\t\t\tif (!flow.length) {\n\t\t\t\t\t\t\t\t\t\tcbDone();\n\t\t\t\t\t\t\t\t\t\tcbItem(-1);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tasync.applyEach(\n\t\t\t\t\t\t\t\t\t\t\tflow,\n\t\t\t\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\t\t\t\tfunction(err) {\n\t\t\t\t\t\t\t\t\t\t\t\tcbDone();\n\t\t\t\t\t\t\t\t\t\t\t\tcbItem(err);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\taction: function(next, cb) {\n\t\t\t\t\t\t\t\tvar call = [],\n\t\t\t\t\t\t\t\t\tlength = (functs.length < concurrency)\n\t\t\t\t\t\t\t\t\t\t? functs.length\n\t\t\t\t\t\t\t\t\t\t: concurrency\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\twhile(length--)\n\t\t\t\t\t\t\t\t\tcall.push(functs.shift());\n\t\t\t\t\t\t\t\tif (call.length > 0) {\n\t\t\t\t\t\t\t\t\tactive = call.length;\n\t\t\t\t\t\t\t\t\tasync.parallel(call, function() {\n\t\t\t\t\t\t\t\t\t\tactive = 0; \n\t\t\t\t\t\t\t\t\t\tnext(cb);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tself.setState($thing.State.LIFE_WAITING);\n\t\t\t\t\t\t\t\t\tnext(cb);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpause: function() {\n\t\t\t\t\t\t\t\tif (!paused) {\n\t\t\t\t\t\t\t\t\tpaused = true;\n\t\t\t\t\t\t\t\t\tself.setState($thing.State.LIFE_WAITING);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tresume: function() {\n\t\t\t\t\t\t\t\tif (paused) {\n\t\t\t\t\t\t\t\t\tpaused = false;\n\t\t\t\t\t\t\t\t\tself.unsetState($thing.State.LIFE_WAITING);\n\t\t\t\t\t\t\t\t\tagent();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t};\n\t\t\t\t\t\tObject.defineProperty(queue, 'length', {\n\t\t\t\t\t\t\tget: function() {\n\t\t\t\t\t\t\t\treturn active + functs.length;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.getQueue = function() {\n\t\t\t\t\t\t\treturn queue;\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn queue;\n\t\t\t\t\t},\n\t\t\t\t\taction: function($cb) {\n\t\t\t\t\t\tthis.getQueue().action(this.bind(this.$super), $cb);\n\t\t\t\t\t},\n\t\t\t\t\t/**\n\t\t\t\t\t * @method Queue#push\n\t\t\t\t\t */\n\t\t\t\t\tpush: function(items, $cb) {\n\t\t\t\t\t\tif (items instanceof Array) {\n\t\t\t\t\t\t\tvar self = this,\n\t\t\t\t\t\t\t\tlength = items.length,\n\t\t\t\t\t\t\t\terrs = [],\n\t\t\t\t\t\t\t\tret\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\titems.forEach(function(item, i) {\n\t\t\t\t\t\t\t\tself.getQueue().push(item, function(err) {\n\t\t\t\t\t\t\t\t\tret = (errs[i] = err) || ret;\n\t\t\t\t\t\t\t\t\t(!--length)\n\t\t\t\t\t\t\t\t\t\t? (ret)\n\t\t\t\t\t\t\t\t\t\t\t? $cb('doneWithError', errs)()\n\t\t\t\t\t\t\t\t\t\t\t: $cb('done')()\n\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.getQueue().push(items, function(err) {\n\t\t\t\t\t\t\t\t(err)\n\t\t\t\t\t\t\t\t\t? $cb('doneWithError', err)()\n\t\t\t\t\t\t\t\t\t: $cb('done')()\n\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tagent();\n\t\t\t\t\t},\n\t\t\t\t\tpause: function($cb) {\n\t\t\t\t\t\tthis.getQueue().pause();\n\t\t\t\t\t\t$cb();\n\t\t\t\t\t},\n\t\t\t\t\tresume: function($cb) {\n\t\t\t\t\t\tthis.getQueue().resume();\n\t\t\t\t\t\t$cb();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Waker\n\t\t\t * @mixes Behaviour\n\t\t\t * @abstract\n\t\t\t */\n\t\t\tthis.addBehaviour(\n\t\t\t\t'abstract Waker', {\n\n\t\t\t\t\t/**\n\t\t\t\t\t * @method Waker#getWakeTime\n\t\t\t\t\t */\n\t\t\t\t\tgetWakeTime: function() {\n\t\t\t\t\t\tvar time,\n\t\t\t\t\t\t\tperiod = 1000,\n\t\t\t\t\t\t\tnow = Date.now()\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t$thing.searchMeta(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'period',\n\t\t\t\t\t\t\t'int',\n\t\t\t\t\t\t\tfunction(value) {\n\t\t\t\t\t\t\t\tperiod = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\t\n\t\t\t\t\t\ttime = now % period + now;\n\n\t\t\t\t\t\tthis.getWakeTime = function() {\n\t\t\t\t\t\t\treturn time;\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn this.getWakeTime();\n\t\t\t\t\t},\n\n\t\t\t\t\t/**\n\t\t\t\t\t * @method Waker#wake\n\t\t\t\t\t */\n\t\t\t\t\twake: function($cb) {\n\t\t\t\t\t\tvar time = this.getWakeTime();\n\n\t\t\t\t\t\tif (time === undefined)\n\t\t\t\t\t\t\tthis.$owner.removeBehaviour(this);\n\n\t\t\t\t\t\tif ($cb !== undefined)\n\t\t\t\t\t\t\t$cb();\n\t\t\t\t\t},\n\n\t\t\t\t\taction: function($cb) {\n\t\t\t\t\t\tvar now = Date.now(),\n\t\t\t\t\t\t\ttime = this.getWakeTime()\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif (time !== undefined) {\n\t\t\t\t\t\t\tif (time - now <= 0) {\n\t\t\t\t\t\t\t\tthis.getWakeTime = function() {\n\t\t\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tagent(this)('wake')();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.$super($cb);\n\t\t\t\t\t},\n\n\t\t\t\t\tdone: function() {\n\t\t\t\t\t\tvar now = Date.now(),\n\t\t\t\t\t\t\ttime = this.getWakeTime()\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif (time === undefined)\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\telse if (time - now <= 0)\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t},\n\n\t\t\t\t\treset: function($cb) {\n\t\t\t\t\t\tdelete this.getWakeTime;\n\t\t\t\t\t\tthis.$super($cb);\n\t\t\t\t\t},\n\n\t\t\t\t\t/**\n\t\t\t\t\t * @method Waker#stop\n\t\t\t\t\t */\n\t\t\t\t\tstop: function($cb) {\n\t\t\t\t\t\tthis.$owner.removeBehaviour(this);\n\t\t\t\t\t\tif ($cb !== undefined)\n\t\t\t\t\t\t\t$cb();\n\t\t\t\t\t}\n \n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * @class Sensor\n\t\t\t * @mixes Queue\n\t\t\t * @abstract\n\t\t\t */\n\t\t\tthis.addBehaviour('abstract Sensor extends Queue');\n\n\t\t\t/**\n\t\t\t * @class Actuator\n\t\t\t * @mixes Queue\n\t\t\t * @abstract\n\t\t\t */\n\t\t\tthis.addBehaviour('abstract Actuator extends Queue');\n\t\t}\n\t});\n\n})(this);\n"]}